{"version":3,"sources":["webpack:///./scripts/components/CPM/CPMRegistration.jsx","webpack:///./scripts/components/CPM/actions/cpmupdate.js","webpack:///./scripts/components/CPM/presentational/MarketingLinks.jsx","webpack:///./scripts/components/CPM/presentational/MarketingText.jsx"],"names":["CPMRegistrationApp","props","registerEmailNode","handleEmailChange","event","registerEmail","target","value","isError","errors","regexPatterns","email","cpmService","getCPMData","then","data","setState","prevState","cpmdataupdated","cpminit","toString","cpmdata","length","state","document","getElementById","addEventListener","removeEventListener","val","React","Component","$cpmGETURL","$cpmGuestGETURL","$cpmRegisterGETURL","getContainer","getPaymentContainer","getIsCPM","paymentContainer","dataset","iscpm","JSON","parse","getCSRF","container","csrf","url","params","Promise","resolve","reject","axios","get","response","catch","sendCPMData","post","status","error","createCPMObject","cpmObject","config","marketingOptions","slice","map","item","hasOwnProperty","name","MarketingLinks","termsAndPrivacy","terms","link","linkText","privacy","MarketingText","subheader","subheader2","label","isCPMOn","setCPMData","setSubheader","setLabel","setInputName","setUnselected","setSelected","stayInTouch","header","id","e","changeValue","checked","propTypes","PropTypes","string","isRequired","bool","func"],"mappings":"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","file":"CPMRegistration.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport cpmService from './actions/cpmupdate';\nimport isError from '../../helpers/isError';\nimport MarketingText from './presentational/MarketingText';\nimport errors from '../../config/errors';\nimport axios from 'axios';\n\nclass CPMRegistrationApp extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      cpmdataupdated: false,\n      cpminit: null,\n      cpmdata: null\n    };\n  }\n\n  registerEmailNode = null;\n\n  componentDidMount() {\n    const registerEmailNode = document.getElementById('register_email');\n    if (registerEmailNode) {\n      const value = registerEmailNode.value;\n      if (value) {\n        this.registerEmail(value);\n      }\n      registerEmailNode.addEventListener('blur', this.handleEmailChange, true);\n      this.registerEmailNode = registerEmailNode;\n    }\n  }\n\n  componentWillUnmount() {\n    const registerEmailNode = this.registerEmailNode;\n    if (registerEmailNode) {\n      registerEmailNode.removeEventListener('blur', this.handleEmailChange, true);\n    }\n  }\n\n  handleEmailChange = (event) => {\n    this.registerEmail(event.target.value);\n  }\n\n  registerEmail = (value) => {\n    if (isError(value, errors.regexPatterns.email)) {\n      cpmService.getCPMData('$cpmRegisterGETURL', { email: value }).then((data) => {\n        if (data !== null) {\n          this.setState(prevState => ({\n            cpmdataupdated: true,\n            cpminit: data.toString(),\n            cpmdata: (data === null || data.length === 0) ? 'li' : data.toString()\n          }));\n        }\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        { this.state.cpminit !== 'true' && this.state.cpminit !== 'li' && this.state.cpmdataupdated === true  &&\n          <MarketingText\n            cpmdata={this.state.cpmdata}\n            cpminit={this.state.cpminit}\n            subheader={this.state.cpminit === 'false' ? 'subheader' : 'subheaderunknown' }\n            subheader2={this.state.cpminit === 'false' ? 'subheader2' : 'subheader2unknown' }\n            label={this.state.cpminit === 'false' ? 'label' : 'labelunknown' }\n            setCPMData={(val) => {\n              this.setState(prevState => ({\n                cpmdata: val\n              }));\n            }}\n          />\n        }\n      </div>\n    )\n  }\n}\n\nexport default CPMRegistrationApp;\n","import axios from 'axios';\nimport config from '../config/config';\n\nconst cpmService = (function () {\n  return {\n    $cpmGETURL: '/my-account/marketing-preferences-json',\n    $cpmGuestGETURL: '/checkout/multi/payment-method/tu-marketing-preferences-json',\n    $cpmRegisterGETURL: '/login/tu-marketing-preferences-json',\n    getContainer: function () { return document.getElementById('CPM-account'); },\n    getPaymentContainer: function () { return document.getElementById('paymentDetails'); },\n    getIsCPM: function () {\n      const paymentContainer = this.getPaymentContainer();\n      if (paymentContainer) {\n        const data = paymentContainer.dataset.iscpm;\n        return JSON.parse(data);\n      } else {\n        return false;\n      }\n    },\n    getCSRF: function () {\n      const container = this.getContainer();\n      if (container) {\n        const data = container.dataset.csrf;\n        return data;\n      } else {\n        return false;\n      }\n    },\n    getCPMData: function (url='$cpmGETURL', params={}) {\n      return new Promise((resolve, reject) => {\n        axios.get(this[url], { params: params })\n          .then((response) => {\n            resolve(response.data);\n          })\n          .catch(() => {\n            resolve(null);\n          });\n      });\n    },\n    sendCPMData: function (url='$cpmGETURL', data={}) {\n      return new Promise((resolve, reject) => {\n        axios.post(this[url], data, {\n          params: {\n            \"CSRFToken\": cpmService.getCSRF()\n          }\n        })\n        .then((response) => {\n          if( response.status === 200 ) {\n            resolve(true);\n          }\n        })\n        .catch((error) => {\n          reject(false);\n        });\n      });\n    },\n    createCPMObject: function (data) {\n      let cpmObject = config.marketingOptions.slice();\n\n      cpmObject.map(item => {\n        if (data.hasOwnProperty(item.name)) {\n          item.value = (data[item.name] === null || data[item.name].length === 0) ? null : data[item.name].toString();\n      \t}\n      });\n\n      return cpmObject;\n    }\n  };\n}());\n\nexport default cpmService;\n","import React from 'react';\nimport config from '../config/config';\n\n\nconst MarketingLinks = () => {\n\n  return (\n    <p>\n      Don't worry, we'll never let other companies use your personal details for marketing. Read our <a href={config.termsAndPrivacy.terms.link} className=\"ln-u-text-decoration-underline\">{config.termsAndPrivacy.terms.linkText}</a> and <a href={config.termsAndPrivacy.privacy.link} className=\"ln-u-text-decoration-underline\">{config.termsAndPrivacy.privacy.linkText}</a> to learn more.\n    </p>\n  );\n};\n\nexport default MarketingLinks;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport MarketingLinks from './MarketingLinks';\nimport config from '../config/config';\n\nconst MarketingText = ({subheader, subheader2, label, cpmdata, cpminit, isCPMOn=true, setCPMData}) => {\n  const setSubheader = isCPMOn ? subheader : 'subheadernonCPM';\n  const setLabel = isCPMOn ? label : 'labelnonCPM';\n  const setInputName = isCPMOn ? 'contactPreferences' : 'contactPreferencesAny';\n  const setUnselected = (cpminit === '' || cpminit === null) ? 'li' : cpminit;\n  const setSelected = cpminit === 'false' ? 'true' : 'false';\n  return (\n    <div className=\"form_field-input ln-u-push-bottom\">\n      <h3 className=\"checkout-step-subtitle\">{config.stayInTouch.header}</h3>\n      <p>{config.stayInTouch[setSubheader]}</p>\n      {subheader2 !== '' && isCPMOn === true &&\n        <p>{config.stayInTouch[subheader2]}</p>\n      }\n      { isCPMOn === true &&\n        <MarketingLinks />\n      }\n      <div className=\"ln-c-form-option ln-c-form-option--checkbox\">\n        <input\n          id={config.stayInTouch.id}\n          name={setInputName}\n          type=\"checkbox\"\n          value={!isCPMOn ? 'true' : cpmdata}\n          className=\"ln-c-form-option__input\"\n          onChange={e => {\n            const changeValue = e.target.checked ? setSelected : setUnselected;\n            if (isCPMOn) {\n              setCPMData(changeValue)\n            }\n          }}\n        />\n        <label className=\"ln-c-form-option__label\" htmlFor={config.stayInTouch.id}>\n          {config.stayInTouch[setLabel]}\n        </label>\n        { isCPMOn === true &&\n          <input type=\"hidden\" name='contactPreferencesAny' value={cpmdata} />\n        }\n      </div>\n    </div>\n  );\n};\n\nMarketingText.propTypes = {\n  subheader: PropTypes.string.isRequired,\n  subheader2: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  cpmdata: PropTypes.string.isRequired,\n  cpminit: PropTypes.string.isRequired,\n  isCPMOn: PropTypes.bool,\n  setCPMData: PropTypes.func.isRequired\n};\n\nexport default MarketingText;\n"],"sourceRoot":""}