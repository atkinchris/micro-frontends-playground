(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{315:function(e,t,n){"use strict";n(41),n(139),n(107),n(11),n(24),n(54);var a=n(30),r=n.n(a),o=n(58),i={$cpmGETURL:"/my-account/marketing-preferences-json",$cpmGuestGETURL:"/checkout/multi/payment-method/tu-marketing-preferences-json",$cpmRegisterGETURL:"/login/tu-marketing-preferences-json",getContainer:function(){return document.getElementById("CPM-account")},getPaymentContainer:function(){return document.getElementById("paymentDetails")},getIsCPM:function(){var e=this.getPaymentContainer();if(e){var t=e.dataset.iscpm;return JSON.parse(t)}return!1},getCSRF:function(){var e=this.getContainer();return!!e&&e.dataset.csrf},getCPMData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$cpmGETURL",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a,o){r.a.get(e[t],{params:n}).then((function(e){a(e.data)})).catch((function(){a(null)}))}))},sendCPMData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$cpmGETURL",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a,o){r.a.post(e[t],n,{params:{CSRFToken:i.getCSRF()}}).then((function(e){200===e.status&&a(!0)})).catch((function(e){o(!1)}))}))},createCPMObject:function(e){var t=o.a.marketingOptions.slice();return t.map((function(t){e.hasOwnProperty(t.name)&&(t.value=null===e[t.name]||0===e[t.name].length?null:e[t.name].toString())})),t}};t.a=i},317:function(e,t,n){"use strict";n(107);var a=n(0),r=n.n(a),o=n(2),i=n.n(o),c=function(e){var t=e.id,n=e.title,a=e.name,o=e.value,i=e.onToggle,c=e.altStyle;return r.a.createElement("li",{className:"ln-o-bare-list__item"},r.a.createElement("label",{className:"ln-c-form-slider ".concat(c||""),htmlFor:t},r.a.createElement("span",{className:"ln-c-form-slider__title ln-u-font-size-h5"},n),r.a.createElement("input",{type:"checkbox",id:t,name:t,className:"ln-u-hidden",onChange:function(e){var t=e.target.checked?"true":"false";i(a,t)},defaultChecked:"true"===o||"li"===o}),r.a.createElement("span",{className:"ln-c-form-slider__mechanism"},r.a.createElement("span",{className:"ln-c-form-slider__state"}))))};c.propTypes={id:i.a.string.isRequired,title:i.a.string.isRequired,name:i.a.string.isRequired,value:i.a.string.isRequired,onToggle:i.a.func.isRequired},t.a=c},330:function(e,t,n){"use strict";n.r(t);n(12),n(53),n(56),n(44),n(41),n(107),n(87),n(85),n(86),n(11),n(57),n(48);var a=n(0),r=n.n(a),o=(n(2),n(315)),i=n(317),c=n(58);n(30);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=m(t).call(this,e))||"object"!==s(r)&&"function"!=typeof r?f(a):r).state={cpmdataupdated:!1,cpmdata:[],cpmobject:{},saveConfirmed:!1},n.setCPMData=n.setCPMData.bind(f(n)),n.sendCPMData=n.sendCPMData.bind(f(n)),n.updateCPMData=n.updateCPMData.bind(f(n)),n.dataSaved=n.dataSaved.bind(f(n)),n}var n,a,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(a=[{key:"updateCPMData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object.assign({},this.state.cpmobject,u({},e,t));this.setState((function(e){return{cpmobject:n}}))}},{key:"dataSaved",value:function(){var e=this;setTimeout((function(){e.setState((function(e){return{saveConfirmed:!e.saveConfirmed}}))}),c.a.dataSavedTimeout)}},{key:"sendCPMData",value:function(){var e=this;o.a.sendCPMData("$cpmGETURL",this.state.cpmobject).then((function(t){e.setState((function(e){return{saveConfirmed:t}})),e.dataSaved()}))}},{key:"setCPMData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};e.map((function(e){t[e.name]=null})),this.setState((function(n){return{cpmdataupdated:!0,cpmdata:e,cpmobject:t}}))}},{key:"componentWillMount",value:function(){var e=this;this.state.cpmdataupdated||o.a.getCPMData("$cpmGETURL").then((function(t){e.setCPMData(o.a.createCPMObject(t))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"ln-u-soft-top"},r.a.createElement("h2",{className:"ln-u-h2"},c.a.marketingHeader),r.a.createElement("p",{className:"ln-u-h5"},c.a.marketingSubtext1),r.a.createElement("p",null,c.a.marketingSubtext2),r.a.createElement("p",{className:"ln-u-soft-bottom"},"Don't worry, we'll never let other companies use your personal details for marketing. Read our ",r.a.createElement("a",{href:"https://help.sainsburys.co.uk/help/website/privacy-policy-commitment",className:"ln-u-text-decoration-underline"},"privacy policy")," and ",r.a.createElement("a",{href:"/help/cookies",className:"ln-u-text-decoration-underline"},"cookie policy")," to learn more."),r.a.createElement("hr",null),r.a.createElement("div",{className:"ln-u-3/5@xs ln-u-soft-bottom"},r.a.createElement("ul",{className:"ln-o-bare-list ln-o-bare-list--spaced ln-u-soft-bottom"},this.state.cpmdata.map((function(t){return r.a.createElement(i.a,{id:t.id,key:t.id,name:t.name,title:t.title,value:t.value,onToggle:function(t,n){return e.updateCPMData(t,n)}})}))),r.a.createElement("div",{className:this.state.saveConfirmed?"ln-c-form-slider__confirmed ln-c-form-slider__confirmed--show":"ln-c-form-slider__confirmed"},r.a.createElement("p",{className:"ln-u-h5 ln-u-flush-bottom"},c.a.dataSavedText)),!0===this.state.cpmdataupdated&&r.a.createElement("div",{className:"ln-u-soft-ends"},r.a.createElement("button",{className:"ln-c-button ln-c-button--primary",type:"submit",onClick:function(t){t.preventDefault(),e.sendCPMData()}},c.a.marketingButton))))}}])&&l(n.prototype,a),p&&l(n,p),t}(r.a.Component);t.default=p}}]);