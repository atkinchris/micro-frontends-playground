{"version":3,"sources":["webpack:///./scripts/components/Recommendations/Recommendations.container.js","webpack:///./scripts/components/Recommendations/Recommendations.proptypes.js","webpack:///./scripts/components/Recommendations/RecommendationsCategories.presentational.js","webpack:///./scripts/components/Recommendations/RecommendationsCategory.presentational.js","webpack:///./scripts/components/Recommendations/RecommendationsCategoryHeader.presentational.jsx","webpack:///./scripts/components/Recommendations/RecommendationsList.presentational.js","webpack:///./scripts/components/Recommendations/RecommendedProduct.presentational.jsx","webpack:///./scripts/components/Recommendations/config/config.js","webpack:///./scripts/components/Recommendations/helpers/peeriusHelper.js"],"names":["Recommendations","props","getPeeriusAPIData","productCode","peeriusHelper","createPeeriusHelper","config","window","PeeriusCallbacks","smartRecs","jsonData","determineRecommendations","recommendationsCategories","setState","shownRecommendationIds","forEach","category","push","recommendations","map","id","sendPeeriusRecs","productLimit","items","length","slice","ids","Peerius","sendAjax","sainsburysPeeriusURL","join","sendPeeriusRecsClick","recommendationId","smartRecsClick","state","React","Component","propTypes","PropTypes","string","isRequired","recommendedProductPricePropType","shape","formattedPromotionPrice","formattedValue","formattedWasPrice","formattedWasWasPrice","recommendedProductImagePropType","format","url","recommendedProductPropType","code","name","images","arrayOf","fromLabelRequired","price","recommendationPropType","number","refCode","recommendedProduct","recommendationsCategoryPropType","header","RecommendationsCategories","categories","onRecommendationClick","filter","index","func","RecommendationsCategory","RecommendationsCategoryHeader","RecommendationsList","product","i","RecommendedProduct","recClick","hasWasPrice","hasWasWasPrice","isPriceAndPromotionPriceSame","createProductPriceStyle","productPriceStyle","fromLabelStyle","promotionPriceStyle","priceStyle","previousPriceStyle","styleSku","split","isFromLabelRequired","toLowerCase","replace","defaultProps","argosUrl","tuUrl","productSkuTest","argosParams","productCodeSku","channel","placement","itemId","tuParams","skuCodes","productCodes","peeriusHelperFactory","maxRecsPerCategory","findCategoryByAlias","alias","find","applyProductLimit","recs","discardUnusedCategories","peeriusCategory","sortCategories","unsortedSmartRecs","sortedSmartRecs","requiredCategory","receivedCategory","createUnpopulatedRecommendationsList","listOfRecommendations","limitedRecs","createUnpopulatedRecommendationCategories","extractAllRefCodes","refCodes","fetchProducts","productsUrl","axiosGetHelper","then","response","data","catch","populateRecommendationsWithProductDetails","recommendationCategories","products","updatedCategories","updatedRecommendations","recommendation","fetchRecommendedProductDetails","unpopulatedRecommendationCategories","smartRecsOfInterest","sortedSmartRecsOfInterest","productDetails","populatedRecommendationsCategories"],"mappings":"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","file":"Recommendations.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport config from './config/config';\nimport createPeeriusHelper from './helpers/peeriusHelper';\nimport RecommendationsCategories from './RecommendationsCategories.presentational';\n\nclass Recommendations extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      recommendationsCategories: []\n    };\n  }\n\n  componentDidMount() {\n    this.getPeeriusAPIData();\n  }\n\n  getPeeriusAPIData = () => {\n    const { productCode } = this.props;\n    const peeriusHelper = createPeeriusHelper(config);\n\n    if (productCode) {\n      // create global object\n      window.PeeriusCallbacks = {\n        ...window.PeeriusCallbacks,\n        smartRecs: async (jsonData) => {\n          if (jsonData) {\n            const recommendationsCategories = await peeriusHelper.determineRecommendations(jsonData);\n\n            if (recommendationsCategories) {\n              this.setState({ recommendationsCategories });\n\n              const shownRecommendationIds = [];\n              recommendationsCategories.forEach((category) => {\n                shownRecommendationIds.push(...category.recommendations.map(({ id }) => id));\n              });\n\n              this.sendPeeriusRecs(shownRecommendationIds);\n            }\n          }\n        }\n      };\n      return true;\n    }\n\n    return false;\n  };\n\n  productLimit = items => (items.length > config.productLimit ? items.slice(0, config.productLimit) : items);\n\n  sendPeeriusRecs = (ids) => {\n    window.Peerius.sendAjax(`${config.sainsburysPeeriusURL}${ids.join(',')}`);\n  };\n\n  sendPeeriusRecsClick = (recommendationId = '') => {\n    window.Peerius.smartRecsClick(recommendationId);\n  };\n\n  render() {\n    const { recommendationsCategories } = this.state;\n\n    return (\n      <RecommendationsCategories\n        categories={recommendationsCategories}\n        onRecommendationClick={this.sendPeeriusRecsClick}\n      />\n    );\n  }\n}\n\nRecommendations.propTypes = {\n  productCode: PropTypes.string.isRequired,\n};\n\nexport default Recommendations;\n","import PropTypes from 'prop-types';\n\nconst recommendedProductPricePropType = PropTypes.shape({\n  formattedPromotionPrice: PropTypes.string,\n  formattedValue: PropTypes.string,\n  formattedWasPrice: PropTypes.string,\n  formattedWasWasPrice: PropTypes.string\n});\n\nconst recommendedProductImagePropType = PropTypes.shape({\n  format: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired\n});\n\nconst recommendedProductPropType = PropTypes.shape({\n  code: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  images: PropTypes.arrayOf(recommendedProductImagePropType).isRequired,\n  fromLabelRequired: PropTypes.string.isRequired,\n  price: recommendedProductPricePropType\n});\n\nconst recommendationPropType = PropTypes.shape({\n  id: PropTypes.number.isRequired,\n  refCode: PropTypes.string.isRequired,\n  recommendedProduct: recommendedProductPropType,\n});\n\nconst recommendationsCategoryPropType = PropTypes.shape({\n  id: PropTypes.string.isRequired,\n  header: PropTypes.string.isRequired,\n  recommendations: PropTypes.arrayOf(recommendationPropType)\n});\n\nexport {\n  recommendedProductPricePropType,\n  recommendedProductImagePropType,\n  recommendedProductPropType,\n  recommendationPropType,\n  recommendationsCategoryPropType\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport RecommendationsCategory from './RecommendationsCategory.presentational';\nimport { recommendationsCategoryPropType } from './Recommendations.proptypes';\n\nconst RecommendationsCategories = ({ categories, onRecommendationClick }) => (\n  <>\n    {\n      categories\n        .filter(category => category.recommendations.length > 0)\n        .map((category, index) => (\n          <RecommendationsCategory\n            key={`recommendations-category-${index}`}\n            category={category}\n            onRecommendationClick={onRecommendationClick}\n          />\n        ))\n    }\n  </>\n);\n\nRecommendationsCategories.propTypes = {\n  categories: PropTypes.arrayOf(recommendationsCategoryPropType).isRequired,\n  onRecommendationClick: PropTypes.func.isRequired\n};\n\nexport default RecommendationsCategories;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport RecommendationsCategoryHeader from './RecommendationsCategoryHeader.presentational';\nimport RecommendationsList from './RecommendationsList.presentational';\nimport { recommendationsCategoryPropType } from './Recommendations.proptypes';\n\nconst RecommendationsCategory = ({\n  category: { id, header, recommendations },\n  onRecommendationClick\n}) => (\n  <div className='ln-o-grid' id={id}>\n    <RecommendationsCategoryHeader header={header} />\n    <RecommendationsList\n      recommendations={recommendations}\n      onRecommendationClick={onRecommendationClick}\n    />\n  </div>\n);\n\nRecommendationsCategory.propTypes = {\n  category: recommendationsCategoryPropType.isRequired,\n  onRecommendationClick: PropTypes.func.isRequired\n};\n\nexport default RecommendationsCategory;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst RecommendationsCategoryHeader = ({ header }) => (\n  <nav className='ln-o-grid__item ln-u-soft-top'>\n    <h2 className='ln-u-h3 ln-u-push-bottom'>{header}</h2>\n  </nav>\n);\n\nRecommendationsCategoryHeader.propTypes = {\n  header: PropTypes.string.isRequired\n};\n\nexport default RecommendationsCategoryHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { recommendationPropType } from './Recommendations.proptypes';\nimport RecommendedProduct from './RecommendedProduct.presentational';\n\nconst RecommendationsList = ({ recommendations, onRecommendationClick }) => (\n  <>\n    {\n      recommendations.map(({ id, recommendedProduct: product }) => (\n        product.price && (\n          <RecommendedProduct\n            key={product.code}\n            url={product.url}\n            code={product.code}\n            images={product.images.length ? product.images.filter(i => i.format === 'thumbnail') : null}\n            name={product.name}\n            fromLabelRequired={product.fromLabelRequired}\n            formattedValue={product.price.formattedValue || null}\n            formattedPromotionPrice={product.price.formattedPromotionPrice || null}\n            formattedWasPrice={product.price.formattedWasPrice || null}\n            formattedWasWasPrice={product.price.formattedWasWasPrice || null}\n            recClick={() => onRecommendationClick(id)}\n          />\n        )))\n    }\n  </>\n);\n\nRecommendationsList.propTypes = {\n  recommendations: PropTypes.arrayOf(recommendationPropType).isRequired,\n  onRecommendationClick: PropTypes.func.isRequired\n};\n\nexport default RecommendationsList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst RecommendedProduct = (props) => {\n  const {\n    code, url, images, name, formattedValue, formattedWasPrice, formattedWasWasPrice, formattedPromotionPrice, fromLabelRequired, recClick\n  } = props;\n  const hasWasPrice = !!formattedWasPrice;\n  const hasWasWasPrice = !!formattedWasWasPrice;\n\n  const isPriceAndPromotionPriceSame = formattedPromotionPrice === formattedValue;\n\n  const createProductPriceStyle = () => {\n    let productPriceStyle = '';\n\n    if (formattedPromotionPrice && !isPriceAndPromotionPriceSame) {\n      productPriceStyle = 'tu-u-text-line-through ln-u-soft-right*1/4 ln-u-display-inline-block';\n    } else if (hasWasPrice || hasWasWasPrice) {\n      productPriceStyle = 'tu-u-color-red ln-u-soft-right*1/4 ln-u-display-inline-block';\n    }\n    return productPriceStyle;\n  };\n\n  const fromLabelStyle = 'ln-u-soft-right*1/4 ln-u-display-inline-block';\n  const promotionPriceStyle = `ln-u-soft-right*1/4 ln-u-display-inline-block ${formattedValue ? 'tu-u-color-red' : ''}`;\n  const priceStyle = createProductPriceStyle();\n  const previousPriceStyle = 'tu-u-text-line-through ln-u-soft-right*1/4 ln-u-display-inline-block';\n\n  const styleSku = code.split('-')[0];\n  const isFromLabelRequired = fromLabelRequired.toLowerCase() === 'y';\n\n  return (\n    <div className='ln-o-grid__item ln-u-1/2 ln-u-1/4@sm ln-u-push-bottom' data-id={styleSku}>\n      <a\n        href={url.replace('http:', 'https:')}\n        className='ln-u-text-decoration-normal ln-u-display-block'\n        onClick={() => recClick()}\n      >\n        <img\n          src={images ? images['0'].url : ''}\n          className='ln-u-1/1'\n          alt={name}\n          title={name}\n        />\n        <span>\n          <span className='ln-u-h5'>{name}</span>\n          <br />\n          <span className='ln-u-h5 ln-u-font-weight-regular'>\n            {\n              isFromLabelRequired\n              && <span className={fromLabelStyle}>From</span>\n            }\n            {\n              (formattedPromotionPrice && !isPriceAndPromotionPriceSame)\n              && <span test-id='promotionPrice' className={promotionPriceStyle}>{formattedPromotionPrice}</span>\n            }\n            <span test-id='price' className={priceStyle}>{formattedValue}</span>\n            {\n              (hasWasPrice && isPriceAndPromotionPriceSame)\n              && <span test-id='wasPrice' className={previousPriceStyle}>{formattedWasPrice}</span>\n            }\n            {\n              (hasWasWasPrice && isPriceAndPromotionPriceSame)\n              && <span test-id='wasWasPrice' className={previousPriceStyle}>{formattedWasWasPrice}</span>\n            }\n          </span>\n        </span>\n      </a>\n    </div>\n  );\n};\n\nRecommendedProduct.propTypes = {\n  code: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  images: PropTypes.arrayOf(PropTypes.shape({\n    url: PropTypes.string.isRequired\n  })).isRequired,\n  formattedValue: PropTypes.string,\n  recClick: PropTypes.func.isRequired,\n  fromLabelRequired: PropTypes.string,\n  formattedPromotionPrice: PropTypes.string,\n  formattedWasPrice: PropTypes.string,\n  formattedWasWasPrice: PropTypes.string\n};\n\nRecommendedProduct.defaultProps = {\n  fromLabelRequired: '',\n  formattedValue: '',\n  formattedWasPrice: '',\n  formattedWasWasPrice: '',\n  formattedPromotionPrice: ''\n};\n\nexport default RecommendedProduct;\n","export default {\n  argosUrl: 'https://www.argos.co.uk/recommendations-api?',\n  tuUrl: '/products?productCodes=',\n  sainsburysPeeriusURL: 'sainsburys/rec/shown.pagex?ids=',\n  productSkuTest: '100091405-Brown',\n  productLimit: 4,\n  argosParams: productCodeSku => ({\n    channel: 'pdp',\n    placement: 'alternatives',\n    itemId: productCodeSku\n  }),\n  tuParams: skuCodes => ({\n    productCodes: skuCodes\n  }),\n  categories: [\n    {\n      id: 'hycContainer',\n      header: 'You may also like'\n    },\n    {\n      id: 'rhcContainer',\n      header: 'We Recommend'\n    }\n  ]\n};\n","import axiosGetHelper from '../../../helpers/axiosGetHelper/index';\n\nconst peeriusHelperFactory = (config) => {\n  const {\n    categories,\n    productLimit: maxRecsPerCategory\n  } = config;\n\n  // Given an alias, find the matching category in our list of required categories\n  const findCategoryByAlias = alias => categories.find(category => category.header === alias);\n\n  // For the given list of recommendations truncate after the first 'maxRecsPerCategory' items\n  const applyProductLimit = recs => recs.slice(0, maxRecsPerCategory);\n\n  // Filter out any categories not included in the categories in our config\n  const discardUnusedCategories = smartRecs => (\n    smartRecs.filter(peeriusCategory => findCategoryByAlias(peeriusCategory.alias))\n  );\n\n  // Sort the smartRecs in to the same order as the categories in config\n  const sortCategories = (unsortedSmartRecs) => {\n    const sortedSmartRecs = [];\n\n    categories.forEach((requiredCategory) => {\n      const receivedCategory = unsortedSmartRecs.find(({ alias }) => requiredCategory.header === alias);\n      if (receivedCategory) {\n        sortedSmartRecs.push(receivedCategory);\n      }\n    });\n\n    return sortedSmartRecs;\n  };\n\n  // Create a list of base recommendation objects limited to the max number allowed per category\n  const createUnpopulatedRecommendationsList = (listOfRecommendations) => {\n    const limitedRecs = applyProductLimit(listOfRecommendations);\n    return limitedRecs.map(({ id, refCode }) => ({ id, refCode }));\n  };\n\n  // Create a list of base recommendation category objects\n  const createUnpopulatedRecommendationCategories = recs => (\n    recs.map(\n      (peeriusCategory) => {\n        const { id, header } = findCategoryByAlias(peeriusCategory.alias);\n        const recommendations = createUnpopulatedRecommendationsList(peeriusCategory.recs);\n        return { id, header, recommendations };\n      }\n    )\n  );\n\n  // Create a list of all recommendation ids from the recommendation categories\n  const extractAllRefCodes = (recommendationsCategories) => {\n    const refCodes = [];\n\n    recommendationsCategories.forEach((category) => {\n      refCodes.push(...category.recommendations.map(({ refCode }) => refCode));\n    });\n\n    return refCodes;\n  };\n\n  // Request details of the specified products\n  const fetchProducts = (refCodes) => {\n    const productsUrl = `${config.tuUrl}${refCodes.join(',')}`;\n\n    return axiosGetHelper(productsUrl)\n      .then(response => response.data)\n      .catch(() => ([]));\n  };\n\n  // Populate the recommendations in recommednationsCategories with allr equired product details\n  const populateRecommendationsWithProductDetails = (recommendationCategories, products) => {\n    const updatedCategories = [];\n\n    recommendationCategories.forEach((category) => {\n      const updatedRecommendations = [];\n\n      category.recommendations.forEach((recommendation) => {\n        const recommendedProduct = products.find(product => recommendation.refCode === product.code);\n\n        if (recommendedProduct) {\n          updatedRecommendations.push({ ...recommendation, recommendedProduct });\n        }\n      });\n\n      updatedCategories.push({ ...category, recommendations: updatedRecommendations });\n    });\n\n    return updatedCategories;\n  };\n\n  // Fetch the details of all products for which we have recommendations\n  const fetchRecommendedProductDetails = async (unpopulatedRecommendationCategories) => {\n    const refCodes = extractAllRefCodes(unpopulatedRecommendationCategories);\n    const products = await fetchProducts(refCodes);\n\n    return products;\n  };\n\n  // For a given set of Peerius smartRecs determine the recommendations we will display\n  const determineRecommendations = async (smartRecs) => {\n    const smartRecsOfInterest = discardUnusedCategories(smartRecs);\n    const sortedSmartRecsOfInterest = sortCategories(smartRecsOfInterest);\n    const unpopulatedRecommendationCategories = createUnpopulatedRecommendationCategories(sortedSmartRecsOfInterest);\n    const productDetails = await fetchRecommendedProductDetails(unpopulatedRecommendationCategories);\n    const populatedRecommendationsCategories = populateRecommendationsWithProductDetails(\n      unpopulatedRecommendationCategories,\n      productDetails\n    );\n\n    return populatedRecommendationsCategories;\n  };\n\n  return {\n    determineRecommendations\n  };\n};\n\nexport default peeriusHelperFactory;\n"],"sourceRoot":""}